<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    // 자바스크립트는 비동기적 언어
    let sum = 0
    function work(callback){
      setTimeout(()=>{
        const start = Date.now()
        for(let i=0; i<1000000000; i++){
          sum+=i
        }
        const end = Date.now()
        console.log(end-start+"ms")
        callback()
      },0)
    }
    console.log("작업 시작!")
    work(()=>{
      console.log(sum)
    })
    console.log("다음 작업")
    /* 
      비동기적으로 처리하는 자바스크립트 내부 함수 
      AJAX API 요청
      파일 읽기
      암호화/복호화
      작업예약/작업 반복(setTimeout, setInterval)
    */
    /* fetch api 이용 */
    /* 
      프로미스(promise)는 비동기 작업의 결과를 나타내는 객체다. 프로미스를 이용하면 비동기 호출을 실행할 때 코드를 간소화할 수 있다.
      프로미스는 다음 세 가지 상태 중 하나일 수 있다.
      대기 : 초기 상태
      이행 : 작업 성공
      거부 : 작업 실패
    */
    /* fetch() 함수는 프로미스를 지원하기 때문에 비동기 호출을 실행할 수 있다.  응답이 반환되면 비동기 호출이 수행되고 then 메서드 내의 콜백 함수가 response를 인수로 받고 실행된다. */
    // fetch()
    //   .then(response=>)
    // response로 필요한 작업을 수행
    // 여러 then 인스턴스를 체인으로 연결할 수 있다. 즉, 여러 비동기 작업을 순서대로 실행할 수 있다.
    // fetch()
    //   .then(response=>에서 데이터를 얻음)
    //   .then(data=> data로 필요한 작업을 수행)
    // catch()를 이용하면 프로미스에 예외 처리를 추가할 수 있다.
    // fetch()
    //   .then(response=>에서 데이터를 얻음)
    //   .then(data=> data로 필요한 작업을 수행)
    //   .catch(error=> error로 실패시 필요한 작업)
    // ECMAScript 2017에는 async/await를 이용하는 최신 비동기 호출 처리 방식이 추가 됐지만 아직은 프로미스만큼 널리 쓰이지 않고 있다. async/await는 프로미스 기반이다. async/await를 이용하려면 await 식을 포함할 수 있는 async 함수를 정의해야 한다
    /* 다음은 async/await를 포함하는 비동기 호출의 예이다 */

    doAsyncCall = async () =>{

    }
    async function doAsyncCall1(){
      const response = await fetch()
      const data = await response.json()
      // dat로 필요한 작업을 수행
      try {
        
      } catch (error) {
        
      }
    }
  </script>
</body>
</html>